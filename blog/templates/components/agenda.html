{% extends "layout.html" %}
{% load static %}
{% block content %}
<div class="container mx-auto px-4 py-6">
    <h1 class="text-center text-3xl font-bold mb-6" style="color: #605dff;">Agenda 2025</h1>

    <!-- Formulario de filtros -->
    <form method="get" class="flex flex-wrap justify-center gap-4 items-end">
        
        <!-- Filtro Mes -->
        <div>
            <label class="block text-gray-700 text-center dark:text-white">Mes</label>
            <select name="mes" class="w-40 border border-gray-300 rounded-lg p-2 dark:text-black">
                <option value="">Todos</option>
                {% for num, nombre in meses_disponibles %}
                    <option value="{{ num }}" {% if mes_seleccionado == num|stringformat:"s" %}selected{% endif %}>
                        {{ nombre }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- Filtro Localidad -->
        <div>
            <label class="block text-gray-700 text-center dark:text-white">Localidad</label>
            <select name="localidad" class="w-40 border border-gray-300 rounded-lg p-2 dark:text-black">
                <option value="">Todas</option>
                {% for localidad in localidades_disponibles %}
                    <option value="{{ localidad }}" {% if localidad_seleccionada == localidad %}selected{% endif %}>
                        {{ localidad }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- BotÃ³n -->
        <div class="flex justify-center">
            <button type="submit" class="w-40 bg-[#605dff] text-white font-bold py-2 px-4 rounded-lg">
                Filtrar
            </button>
        </div>
    </form>

    <!-- Eventos -->
    <div class="mt-8">
        {% if eventos %}
            {% for fecha, lista_eventos in eventos.items %}
                <h2 class="text-lg font-semibold mt-6">{{ fecha }}</h2>
                <div class="grid md:grid-cols-3 gap-6 mt-4">
                    {% for ev in lista_eventos %}
                        <a href="{% url 'evento_agenda' ev.id %}" class="block bg-white shadow-md rounded-lg overflow-hidden hover:shadow-lg transition-shadow duration-200 dark:text-black">
                            {% if ev.imagen %}
                                <img src="{{ ev.imagen.url }}" alt="{{ ev.titulo }}" class="w-full h-48 object-cover">
                            {% else %}
                                <img src="{% static 'img/default_event.jpg' %}" alt="Imagen no disponible" class="w-full h-48 object-cover">
                            {% endif %}
                            <div class="p-4">
                                <h3 class="text-xl font-bold mb-2">{{ ev.titulo }}</h3>
                                <p class="text-gray-600">{{ ev.localidad }}</p>
                            </div>
                        </a>
                    {% endfor %}
                </div>
            {% endfor %}
        {% else %}
            <p class="text-gray-500 mt-4">No hay eventos para los filtros seleccionados.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
